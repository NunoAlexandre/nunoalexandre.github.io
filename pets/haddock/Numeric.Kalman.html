<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta name="viewport" content="width=device-width, initial-scale=1"><link href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700" rel="stylesheet"><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><title>Numeric.Kalman</title><link href="ocean.css" rel="stylesheet" type="text/css" title="Ocean" /><script src="haddock-util.js" type="text/javascript"></script><script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script><script type="text/javascript">//<![CDATA[
window.onload = function () {pageLoad();setSynopsis("mini_Numeric-Kalman.html");};
//]]>
</script></head><body><div id="package-header"><div class="caption">kalman-1.0.0.2: Kalman and particle filters and smoothers</div><ul class="links" id="page-menu"><li><a href="src/Numeric.Kalman.html">Source</a></li><li><a href="/package/kalman-1.0.0.2">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th>Copyright</th><td>(c) 2016 FP Complete Corporation</td></tr><tr><th>License</th><td>MIT (see LICENSE)</td></tr><tr><th>Maintainer</th><td>dominic@steinitz.org</td></tr><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Numeric.Kalman</p></div><div id="description"><p class="caption">Description</p><div class="doc"><h1>The Theory</h1><p>The model for the extended Kalman filter is given by</p><p>\[
 \begin{aligned}
 \boldsymbol{x}_i &amp;= \boldsymbol{a}_i(\boldsymbol{x}_{i-1}, \boldsymbol{u}_{i-1}) + \boldsymbol{\psi}_{i-1} \\
 \boldsymbol{y}_i &amp;= \boldsymbol{h}_i(\boldsymbol{x}_i) + \boldsymbol{\upsilon}_i
 \end{aligned}
 \]</p><p>where</p><ul><li>\(\boldsymbol{a_i}\) is some non-linear vector-valued possibly
 time-varying state update function.</li><li>\(\boldsymbol{x_i}\) is the state at time \(i\).</li><li>\(\boldsymbol{u_i}\) is the control at time \(i\).</li><li>\(\boldsymbol{\psi}_{i}\) are independent normally
 distributed random variables with mean 0 representing the fact that
 the state update is noisy: \(\boldsymbol{\psi}_{i} \sim {\cal{N}}(0,Q_i)\).</li><li>\(\boldsymbol{h}_i\) is some non-linear vector-valued possibly time-varying
 function describing how we observe the hidden state process.</li><li>\(\boldsymbol{y_i}\) is the observable at time \(i\).</li><li>\(\boldsymbol{\upsilon}_i\) are independent normally
 distributed random variables with mean 0 represent the fact that
 the observations are noisy: \(\boldsymbol{\upsilon}_{i} \sim {\cal{N}}(0,R_i)\).</li></ul><p>Note that in most presentations of the Kalman filter (the
 <a href="https://en.wikipedia.org/wiki/Kalman_filter">wikipedia</a>
 presentation being an exception), the state update function and the
 observation function are taken to be constant over time as is the
 noise for the state and the noise for
 the observation. In symbols, \(\forall i \, \boldsymbol{a}_i = \boldsymbol{a}\)
 for some \(\boldsymbol{a}\), \(\forall i \, \boldsymbol{h}_i = \boldsymbol{h}\)
 for some \(\boldsymbol{h}\),
 \(\forall i \, Q_i = Q\) for some \(Q\) and \(\forall i \, \boldsymbol{a}_i = R\)
 for some \(R\).</p><p>We assume the whole process starts at 0 with our belief of the state (aka the
 prior state) being given by
 \(\boldsymbol{x}_0 \sim {\cal{N}}(\boldsymbol{\mu}_0, \Sigma_0)\)</p><p>The Kalman filtering process is a recursive procedure as follows:</p><ol><li>Make a prediction of the current system state, given our previous
 estimation of the system state.</li><li>Update our prediction, given a newly acquired measurement.</li></ol><p>The prediction and update steps depend on our system and measurement
 models, as well as our current estimate of the system state.</p><h1>An Extended Example</h1><p>The equation of motion for a pendulum of unit length subject to
 <a href="https://en.wikipedia.org/wiki/White_noise#Mathematical_definitions">Gaussian white
 noise</a>
 is</p><p>\[
 \frac{\mathrm{d}^2\alpha}{\mathrm{d}t^2} = -g\sin\alpha + w(t)
 \]</p><p>We can discretize this via the usual <a href="https://en.wikipedia.org/wiki/Euler_method">Euler method</a></p><p>\[
 \begin{bmatrix}
 x_{1,i} \\
 x_{2,i}
 \end{bmatrix}
 =
 \begin{bmatrix}
 x_{1,i-1} + x_{2,i-1}\Delta t \\
 x_{2,i-1} - g\sin x_{1,i-1}\Delta t
 \end{bmatrix}
 +
 \mathbf{q}_{i-1}
 \]</p><p>where \(q_i \sim {\mathcal{N}}(0,Q)\) and</p><p>\[
 Q
 =
 \begin{bmatrix}
 \frac{q^c \Delta t^3}{3} &amp; \frac{q^c \Delta t^2}{2} \\
 \frac{q^c \Delta t^2}{2} &amp; {q^c \Delta t}
 \end{bmatrix}
 \]</p><p>Assume that we can only measure the horizontal position of the
 pendulum and further that this measurement is subject to error so that</p><p>\[
 y_i = \sin x_i + r_i
 \]</p><p>where \(r_i \sim {\mathcal{N}}(0,R)\).</p><p>First let's set the time step and the acceleration caused by earth's gravity.</p><pre>{-# LANGUAGE DataKinds #-}

import Numeric.Kalman

deltaT, g :: Double
deltaT = 0.01
g  = 9.81
bigQ :: Sym 2
bigQ = sym $ matrix bigQl

qc :: Double
qc = 0.01

bigQl :: [Double]
bigQl = [ qc * deltaT^3 / 3, qc * deltaT^2 / 2,
          qc * deltaT^2 / 2,       qc * deltaT
        ]

bigR :: Sym 1
bigR  = sym $ matrix [0.1]
stateUpdate :: R 2 -&gt; R 2
stateUpdate u =  vector [x1 + x2 * deltaT, x2 - g * (sin x1) * deltaT]
  where
    (x1, w) = headTail u
    (x2, _) = headTail w

observe :: R 2 -&gt; R 1
observe a = vector [sin x] where x = fst $ headTail a
linearizedObserve :: R 2 -&gt; L 1 2
linearizedObserve a = matrix [cos x, 0.0] where x = fst $ headTail a

linearizedStateUpdate :: R 2 -&gt; Sq 2
linearizedStateUpdate u = matrix [1.0,                    deltaT,
                                  -g * (cos x1) * deltaT,    1.0]
  where
    (x1, _) = headTail u</pre><p>Now we can create extended and unscented filters which consume a
 single observation.</p><pre>singleEKF = runEKF (const observe) (const linearizedObserve) (const bigR)
             (const stateUpdate) (const linearizedStateUpdate) (const bigQ)
             undefined</pre><pre>singleUKF = runUKF (const observe) (const bigR) (const stateUpdate) (const bigQ)
             undefined</pre><p>We start off not too far from the actual value.</p><pre>initialDist =  (vector [1.6, 0.0],
                sym $ matrix [0.1, 0.0,
                              0.0, 0.1])</pre><p>Using some data generated using code made available with Simo
 S&#228;rkk&#228;'s
 <a href="http://www.cambridge.org/gb/academic/subjects/statistics-probability/applied-probability-and-stochastic-networks/bayesian-filtering-and-smoothing">book</a>,
 we can track the pendulum using the extended Kalman filter.</p><pre>multiEKF obs = scanl singleEKF initialDist (map (vector . pure) obs)</pre><p>And then plot the results.</p><p><img src="diagrams/src_Numeric_Kalman_diagE.svg#diagram=diagE&amp;height=600&amp;width=500" /></p><p>And also track it using the unscented Kalman filter.</p><pre>multiUKF obs = scanl singleUKF initialDist (map (vector . pure) obs)</pre><p>And also plot the results</p><p><img src="diagrams/src_Numeric_Kalman_diagU.svg#diagram=diagU&amp;height=600&amp;width=500" /></p><h3>Code for Plotting</h3><p>The full code for plotting the results:</p><pre>import qualified Graphics.Rendering.Chart as C
import Graphics.Rendering.Chart.Backend.Diagrams
import Data.Colour
import Data.Colour.Names
import Data.Default.Class
import Control.Lens

import Data.Csv
import System.IO hiding ( hGetContents )
import Data.ByteString.Lazy ( hGetContents )
import qualified Data.Vector as V

import Numeric.LinearAlgebra.Static

chartEstimated :: String -&gt;
              [(Double, Double)] -&gt;
              [(Double, Double)] -&gt;
              [(Double, Double)] -&gt;
              C.Renderable ()
chartEstimated title acts obs ests = C.toRenderable layout
  where

    actuals = C.plot_lines_values .~ [acts]
            $ C.plot_lines_style  . C.line_color .~ opaque red
            $ C.plot_lines_title .~ &quot;Actual Trajectory&quot;
            $ C.plot_lines_style  . C.line_width .~ 1.0
            $ def

    measurements = C.plot_points_values .~ obs
                 $ C.plot_points_style  . C.point_color .~ opaque blue
                 $ C.plot_points_title .~ &quot;Measurements&quot;
                 $ def

    estimas = C.plot_lines_values .~ [ests]
            $ C.plot_lines_style  . C.line_color .~ opaque black
            $ C.plot_lines_title .~ &quot;Inferred Trajectory&quot;
            $ C.plot_lines_style  . C.line_width .~ 1.0
            $ def

    layout = C.layout_title .~ title
           $ C.layout_plots .~ [C.toPlot actuals, C.toPlot measurements, C.toPlot estimas]
           $ C.layout_y_axis . C.laxis_title .~ &quot;Angle / Horizontal Displacement&quot;
           $ C.layout_y_axis . C.laxis_override .~ C.axisGridHide
           $ C.layout_x_axis . C.laxis_title .~ &quot;Time&quot;
           $ C.layout_x_axis . C.laxis_override .~ C.axisGridHide
           $ def

diagE = do
  h &lt;- openFile &quot;data/matlabRNGs.csv&quot; ReadMode
  cs &lt;- hGetContents h
  let df = (decode NoHeader cs) :: Either String (V.Vector (Double, Double))
  case df of
    Left _ -&gt; error &quot;Whatever&quot;
    Right generatedSamples -&gt; do
      let xs = take 500 (multiEKF $ V.toList $ V.map fst generatedSamples)
      let mus = map (fst . headTail . fst) xs
      let obs = V.toList $ V.map fst generatedSamples
      let acts = V.toList $ V.map snd generatedSamples
      denv &lt;- defaultEnv C.vectorAlignmentFns 600 500
      let charte = chartEstimated &quot;Extended Kalman Filter&quot;
                                  (zip [0,1..] acts)
                                  (zip [0,1..] obs)
                                  (zip [0,1..] mus)
      return $ fst $ runBackend denv (C.render charte (600, 500))

diagU = do
  h &lt;- openFile &quot;data/matlabRNGs.csv&quot; ReadMode
  cs &lt;- hGetContents h
  let df = (decode NoHeader cs) :: Either String (V.Vector (Double, Double))
  case df of
    Left _ -&gt; error &quot;Whatever&quot;
    Right generatedSamples -&gt; do
      let ys = take 500 (multiUKF $ V.toList $ V.map fst generatedSamples)
      let nus = map (fst . headTail . fst) ys
      let obs = V.toList $ V.map fst generatedSamples
      let acts = V.toList $ V.map snd generatedSamples
      denv &lt;- defaultEnv C.vectorAlignmentFns 600 500
      let charte = chartEstimated &quot;Unscented Kalman Filter&quot;
                                  (zip [0,1..] acts)
                                  (zip [0,1..] obs)
                                  (zip [0,1..] nus)
      return $ fst $ runBackend denv (C.render charte (600, 500))</pre></div></div><div id="synopsis"><p id="control.syn" class="caption expander" onclick="toggleSection('syn')">Synopsis</p><ul id="section.syn" class="hide" onclick="toggleSection('syn')"><li class="src short"><a href="#v:runKF">runKF</a> :: (<a href="/package/base-4.9.0.0/docs/GHC-TypeLits.html#t:KnownNat">KnownNat</a> m, <a href="/package/base-4.9.0.0/docs/GHC-TypeLits.html#t:KnownNat">KnownNat</a> n) =&gt; (a -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:L">L</a> m n) -&gt; (a -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> m) -&gt; (a -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sq">Sq</a> n) -&gt; (a -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> n) -&gt; a -&gt; (<a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n, <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> n) -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> m -&gt; (<a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n, <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> n)</li><li class="src short"><a href="#v:runKFPrediction">runKFPrediction</a> :: <a href="/package/base-4.9.0.0/docs/GHC-TypeLits.html#t:KnownNat">KnownNat</a> n =&gt; (a -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sq">Sq</a> n) -&gt; (a -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> n) -&gt; a -&gt; (<a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n, <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> n) -&gt; (<a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n, <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> n)</li><li class="src short"><a href="#v:runKFUpdate">runKFUpdate</a> :: (<a href="/package/base-4.9.0.0/docs/GHC-TypeLits.html#t:KnownNat">KnownNat</a> m, <a href="/package/base-4.9.0.0/docs/GHC-TypeLits.html#t:KnownNat">KnownNat</a> n) =&gt; (a -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:L">L</a> m n) -&gt; (a -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> m) -&gt; a -&gt; (<a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n, <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> n) -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> m -&gt; (<a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n, <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> n)</li><li class="src short"><a href="#v:runEKF">runEKF</a> :: (<a href="/package/base-4.9.0.0/docs/GHC-TypeLits.html#t:KnownNat">KnownNat</a> m, <a href="/package/base-4.9.0.0/docs/GHC-TypeLits.html#t:KnownNat">KnownNat</a> n) =&gt; (a -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> m) -&gt; (a -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:L">L</a> m n) -&gt; (a -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> m) -&gt; (a -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n) -&gt; (a -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sq">Sq</a> n) -&gt; (a -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> n) -&gt; a -&gt; (<a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n, <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> n) -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> m -&gt; (<a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n, <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> n)</li><li class="src short"><a href="#v:runEKFPrediction">runEKFPrediction</a> :: <a href="/package/base-4.9.0.0/docs/GHC-TypeLits.html#t:KnownNat">KnownNat</a> n =&gt; (a -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n) -&gt; (a -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sq">Sq</a> n) -&gt; (a -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> n) -&gt; a -&gt; (<a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n, <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> n) -&gt; (<a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n, <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> n)</li><li class="src short"><a href="#v:runEKFUpdate">runEKFUpdate</a> :: (<a href="/package/base-4.9.0.0/docs/GHC-TypeLits.html#t:KnownNat">KnownNat</a> m, <a href="/package/base-4.9.0.0/docs/GHC-TypeLits.html#t:KnownNat">KnownNat</a> n) =&gt; (a -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> m) -&gt; (a -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:L">L</a> m n) -&gt; (a -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> m) -&gt; a -&gt; (<a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n, <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> n) -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> m -&gt; (<a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n, <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> n)</li><li class="src short"><a href="#v:runUKF">runUKF</a> :: (<a href="/package/base-4.9.0.0/docs/GHC-TypeLits.html#t:KnownNat">KnownNat</a> m, <a href="/package/base-4.9.0.0/docs/GHC-TypeLits.html#t:KnownNat">KnownNat</a> n) =&gt; (a -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> m) -&gt; (a -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> m) -&gt; (a -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n) -&gt; (a -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> n) -&gt; a -&gt; (<a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n, <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> n) -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> m -&gt; (<a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n, <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> n)</li><li class="src short"><a href="#v:runUKFPrediction">runUKFPrediction</a> :: <a href="/package/base-4.9.0.0/docs/GHC-TypeLits.html#t:KnownNat">KnownNat</a> n =&gt; (a -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n) -&gt; (a -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> n) -&gt; a -&gt; (<a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n, <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> n) -&gt; (<a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n, <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> n)</li><li class="src short"><a href="#v:runUKFUpdate">runUKFUpdate</a> :: (<a href="/package/base-4.9.0.0/docs/GHC-TypeLits.html#t:KnownNat">KnownNat</a> n, <a href="/package/base-4.9.0.0/docs/GHC-TypeLits.html#t:KnownNat">KnownNat</a> m) =&gt; (a -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> m) -&gt; (a -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> m) -&gt; a -&gt; (<a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n, <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> n) -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> m -&gt; (<a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n, <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> n)</li><li class="src short"><a href="#v:runKS">runKS</a> :: <a href="/package/base-4.9.0.0/docs/GHC-TypeLits.html#t:KnownNat">KnownNat</a> n =&gt; (a -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sq">Sq</a> n) -&gt; (a -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> n) -&gt; a -&gt; (<a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n, <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> n) -&gt; (<a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n, <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> n) -&gt; (<a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n, <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> n)</li><li class="src short"><a href="#v:runEKS">runEKS</a> :: <a href="/package/base-4.9.0.0/docs/GHC-TypeLits.html#t:KnownNat">KnownNat</a> n =&gt; (a -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n) -&gt; (a -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sq">Sq</a> n) -&gt; (a -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> n) -&gt; a -&gt; (<a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n, <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> n) -&gt; (<a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n, <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> n) -&gt; (<a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n, <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> n)</li><li class="src short"><a href="#v:runUKS">runUKS</a> :: <a href="/package/base-4.9.0.0/docs/GHC-TypeLits.html#t:KnownNat">KnownNat</a> n =&gt; (a -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n) -&gt; (a -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> n) -&gt; a -&gt; (<a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n, <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> n) -&gt; (<a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n, <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> n) -&gt; (<a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n, <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> n)</li></ul></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><a id="v:runKF" class="def">runKF</a> <a href="src/Numeric.Kalman.html#runKF" class="link">Source</a> <a href="#v:runKF" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: (<a href="/package/base-4.9.0.0/docs/GHC-TypeLits.html#t:KnownNat">KnownNat</a> m, <a href="/package/base-4.9.0.0/docs/GHC-TypeLits.html#t:KnownNat">KnownNat</a> n)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; (a -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:L">L</a> m n)</td><td class="doc"><p>Linear measurement operator at a point \(\boldsymbol{h}_i\)</p></td></tr><tr><td class="src">-&gt; (a -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> m)</td><td class="doc"><p>Covariance matrix encoding measurement noise \(R_i\)</p></td></tr><tr><td class="src">-&gt; (a -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sq">Sq</a> n)</td><td class="doc"><p>Linear system evolution at a point
 \(\boldsymbol{a}_i(\boldsymbol{u}_{i-1}, \boldsymbol{x}_{i-1})\),
 note the order of the control and the
 input</p></td></tr><tr><td class="src">-&gt; (a -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> n)</td><td class="doc"><p>Covariance matrix encoding system evolution noise \(Q_i\)</p></td></tr><tr><td class="src">-&gt; a</td><td class="doc"><p>Dynamical input \(\boldsymbol{u}_{i-1}\)</p></td></tr><tr><td class="src">-&gt; (<a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n, <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> n)</td><td class="doc"><p>Current estimate
 \((\hat{\boldsymbol{x}}_{i-1}, \hat{\boldsymbol{\Sigma}}_{i-1})\)</p></td></tr><tr><td class="src">-&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> m</td><td class="doc"><p>New measurement \(\boldsymbol{y}_i\)</p></td></tr><tr><td class="src">-&gt; (<a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n, <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> n)</td><td class="doc"><p>New (filtered) estimate \((\hat{\boldsymbol{x}}_i, \hat{\boldsymbol{\Sigma}}_i)\)</p></td></tr></table></div><div class="doc"><p>The ordinary Kalman filter is a special case of the extended Kalman
 filter, when the state update and measurement transformations are
 already linear.</p></div></div><div class="top"><p class="src"><a id="v:runKFPrediction" class="def">runKFPrediction</a> <a href="src/Numeric.Kalman.html#runKFPrediction" class="link">Source</a> <a href="#v:runKFPrediction" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="/package/base-4.9.0.0/docs/GHC-TypeLits.html#t:KnownNat">KnownNat</a> n</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; (a -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sq">Sq</a> n)</td><td class="doc"><p>Linear system evolution at a point
 \(\boldsymbol{a}_i(\boldsymbol{u}_{i-1}, \boldsymbol{x}_{i-1})\),
 note the order of the control and the
 input</p></td></tr><tr><td class="src">-&gt; (a -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> n)</td><td class="doc"><p>Covariance matrix encoding system evolution noise \(Q_i\)</p></td></tr><tr><td class="src">-&gt; a</td><td class="doc"><p>Dynamical input \(\boldsymbol{u}_{i-1}\)</p></td></tr><tr><td class="src">-&gt; (<a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n, <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> n)</td><td class="doc"><p>Current estimate
 \((\hat{\boldsymbol{x}}_{i-1}, \hat{\boldsymbol{\Sigma}}_{i-1})\)</p></td></tr><tr><td class="src">-&gt; (<a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n, <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> n)</td><td class="doc"><p>New prediction
 \(({\boldsymbol{x}_i^\flat}, {\boldsymbol{\Sigma}_i^\flat})\)</p></td></tr></table></div></div><div class="top"><p class="src"><a id="v:runKFUpdate" class="def">runKFUpdate</a> <a href="src/Numeric.Kalman.html#runKFUpdate" class="link">Source</a> <a href="#v:runKFUpdate" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: (<a href="/package/base-4.9.0.0/docs/GHC-TypeLits.html#t:KnownNat">KnownNat</a> m, <a href="/package/base-4.9.0.0/docs/GHC-TypeLits.html#t:KnownNat">KnownNat</a> n)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; (a -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:L">L</a> m n)</td><td class="doc"><p>Linear measurement operator at a point \(\boldsymbol{h}_i\)</p></td></tr><tr><td class="src">-&gt; (a -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> m)</td><td class="doc"><p>Covariance matrix encoding measurement noise \(R_i\)</p></td></tr><tr><td class="src">-&gt; a</td><td class="doc"><p>Dynamical input \(\boldsymbol{u}_{i-1}\)</p></td></tr><tr><td class="src">-&gt; (<a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n, <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> n)</td><td class="doc"><p>Current prediction \(({\boldsymbol{x}}_i^\flat, {\boldsymbol{\Sigma}}_i^\flat)\)</p></td></tr><tr><td class="src">-&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> m</td><td class="doc"><p>New measurement \(\boldsymbol{y}_i\)</p></td></tr><tr><td class="src">-&gt; (<a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n, <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> n)</td><td class="doc"><p>Updated prediction \((\hat{\boldsymbol{x}}_i, \hat{\boldsymbol{\Sigma}}_i)\)</p></td></tr></table></div></div><div class="top"><p class="src"><a id="v:runEKF" class="def">runEKF</a> <a href="src/Numeric.Kalman.html#runEKF" class="link">Source</a> <a href="#v:runEKF" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: (<a href="/package/base-4.9.0.0/docs/GHC-TypeLits.html#t:KnownNat">KnownNat</a> m, <a href="/package/base-4.9.0.0/docs/GHC-TypeLits.html#t:KnownNat">KnownNat</a> n)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; (a -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> m)</td><td class="doc"><p>System measurement function \(\boldsymbol{h}_i\)</p></td></tr><tr><td class="src">-&gt; (a -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:L">L</a> m n)</td><td class="doc"><p>Linearization of the measurement at a point
 \(\frac{\partial \boldsymbol{h}_i}{\partial \boldsymbol{x}}\big|_{\boldsymbol{x}}\)</p></td></tr><tr><td class="src">-&gt; (a -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> m)</td><td class="doc"><p>Covariance matrix encoding measurement noise \(R_i\)</p></td></tr><tr><td class="src">-&gt; (a -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n)</td><td class="doc"><p>System evolution function
 \(\boldsymbol{a}_i(\boldsymbol{u}, \boldsymbol{x})\),
 note the order of the control and the
 input</p></td></tr><tr><td class="src">-&gt; (a -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sq">Sq</a> n)</td><td class="doc"><p>Linearization of the system evolution at a point  \(\frac{\partial \boldsymbol{a}_i}{\partial \boldsymbol{x}}\big|_{{\boldsymbol{u}}, \, {\boldsymbol{x}}}\)</p></td></tr><tr><td class="src">-&gt; (a -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> n)</td><td class="doc"><p>Covariance matrix encoding system evolution noise \(Q_i\)</p></td></tr><tr><td class="src">-&gt; a</td><td class="doc"><p>Dynamical input \(\boldsymbol{u}_{i-1}\)</p></td></tr><tr><td class="src">-&gt; (<a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n, <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> n)</td><td class="doc"><p>Current estimate
 \((\hat{\boldsymbol{x}}_{i-1}, \hat{\boldsymbol{\Sigma}}_{i-1})\)</p></td></tr><tr><td class="src">-&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> m</td><td class="doc"><p>New measurement \(\boldsymbol{y}_i\)</p></td></tr><tr><td class="src">-&gt; (<a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n, <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> n)</td><td class="doc"><p>New (filtered) estimate \((\hat{\boldsymbol{x}}_i, \hat{\boldsymbol{\Sigma}}_i)\)</p></td></tr></table></div><div class="doc"><p>Here we combine the prediction and update setps applied to a new
 measurement, thereby creating a single step of the (extended) Kalman
 filter.</p></div></div><div class="top"><p class="src"><a id="v:runEKFPrediction" class="def">runEKFPrediction</a> <a href="src/Numeric.Kalman.html#runEKFPrediction" class="link">Source</a> <a href="#v:runEKFPrediction" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="/package/base-4.9.0.0/docs/GHC-TypeLits.html#t:KnownNat">KnownNat</a> n</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; (a -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n)</td><td class="doc"><p>System evolution function
 \(\boldsymbol{a}_i(\boldsymbol{u}, \boldsymbol{x})\),
 note the order of the control and the
 input</p></td></tr><tr><td class="src">-&gt; (a -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sq">Sq</a> n)</td><td class="doc"><p>Linearization of the system evolution at a point \(\frac{\partial \boldsymbol{a}_i}{\partial \boldsymbol{x}}\big|_{{\boldsymbol{u}}, \, {\boldsymbol{x}}}\)</p></td></tr><tr><td class="src">-&gt; (a -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> n)</td><td class="doc"><p>Covariance matrix encoding system evolution noise \(Q_i\)</p></td></tr><tr><td class="src">-&gt; a</td><td class="doc"><p>Dynamical input \(\boldsymbol{u}_{i-1}\)</p></td></tr><tr><td class="src">-&gt; (<a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n, <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> n)</td><td class="doc"><p>Current estimate \((\hat{\boldsymbol{x}}_{n-1}, \hat{\boldsymbol{\Sigma}}_{n-1})\)</p></td></tr><tr><td class="src">-&gt; (<a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n, <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> n)</td><td class="doc"><p>New prediction \(({\boldsymbol{x}_i^\flat}, {\boldsymbol{\Sigma}_i^\flat})\)</p></td></tr></table></div><div class="doc"><p>Given our system model and our previous estimate of the system state,
 we generate a prediction of the current system state by taking the
 mean of our estimated state as our point estimate and evolving it one
 step forward with the system evolution function.  In other words, we
 predict that the current system state is the minimum mean squared
 error (MMSE) state, which corresponds to the maximum a posteriori
 (MAP) estimate, from the previous estimate evolved one step by the
 system evolution function of our system model.</p><p>We also generate a predicted covariance matrix by updating the current
 covariance and adding any noise estimate.  Updating the current
 covariance requires the linearized version of the system evolution,
 consequently the deviation of the actual system evolution from its
 linearization is manifested in the newly predicted covariance.</p><p>Taken together, the prediction step generates a new Gaussian
 distribution of predicted system states with mean the evolved MAP
 state from the previous estimate.</p></div></div><div class="top"><p class="src"><a id="v:runEKFUpdate" class="def">runEKFUpdate</a> <a href="src/Numeric.Kalman.html#runEKFUpdate" class="link">Source</a> <a href="#v:runEKFUpdate" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: (<a href="/package/base-4.9.0.0/docs/GHC-TypeLits.html#t:KnownNat">KnownNat</a> m, <a href="/package/base-4.9.0.0/docs/GHC-TypeLits.html#t:KnownNat">KnownNat</a> n)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; (a -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> m)</td><td class="doc"><p>System measurement function \(\boldsymbol{h}_i\)</p></td></tr><tr><td class="src">-&gt; (a -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:L">L</a> m n)</td><td class="doc"><p>Linearization of the observation at a point
 \(\frac{\partial \boldsymbol{h}_i}{\partial \boldsymbol{x}}\big|_{\boldsymbol{x}}\)</p></td></tr><tr><td class="src">-&gt; (a -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> m)</td><td class="doc"><p>Covariance matrix encoding measurement noise \(R_i\)</p></td></tr><tr><td class="src">-&gt; a</td><td class="doc"><p>Dynamical input \(\boldsymbol{u}_{i-1}\)</p></td></tr><tr><td class="src">-&gt; (<a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n, <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> n)</td><td class="doc"><p>Current prediction \(({\boldsymbol{x}}_i^\flat, {\boldsymbol{\Sigma}}_i^\flat)\)</p></td></tr><tr><td class="src">-&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> m</td><td class="doc"><p>New measurement \(\boldsymbol{y}_i\)</p></td></tr><tr><td class="src">-&gt; (<a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n, <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> n)</td><td class="doc"><p>Updated prediction \((\hat{\boldsymbol{x}}_i, \hat{\boldsymbol{\Sigma}}_i)\)</p></td></tr></table></div><div class="doc"><p>After a new measurement has been taken, we update our original
 prediction of the current system state using the result of this
 measurement.  This is accomplished by looking at how much the
 measurement deviated from our prediction, and then updating our
 estimated state accordingly.</p><p>This step requires the linearized measurement transformation.</p></div></div><div class="top"><p class="src"><a id="v:runUKF" class="def">runUKF</a> <a href="src/Numeric.Kalman.html#runUKF" class="link">Source</a> <a href="#v:runUKF" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: (<a href="/package/base-4.9.0.0/docs/GHC-TypeLits.html#t:KnownNat">KnownNat</a> m, <a href="/package/base-4.9.0.0/docs/GHC-TypeLits.html#t:KnownNat">KnownNat</a> n)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; (a -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> m)</td><td class="doc"><p>System measurement function \(\boldsymbol{h}_i\)</p></td></tr><tr><td class="src">-&gt; (a -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> m)</td><td class="doc"><p>Covariance matrix encoding measurement noise \(R_i\)</p></td></tr><tr><td class="src">-&gt; (a -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n)</td><td class="doc"><p>System evolution function
 \(\boldsymbol{a}_i(\boldsymbol{u}, \boldsymbol{x})\),
 note the order of the control and the
 input</p></td></tr><tr><td class="src">-&gt; (a -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> n)</td><td class="doc"><p>Covariance matrix encoding system evolution noise \(Q_i\)</p></td></tr><tr><td class="src">-&gt; a</td><td class="doc"><p>Dynamical input \(\boldsymbol{u}_{i-1}\)</p></td></tr><tr><td class="src">-&gt; (<a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n, <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> n)</td><td class="doc"><p>Current estimate
 \((\hat{\boldsymbol{x}}_{i-1}, \hat{\boldsymbol{\Sigma}}_{i-1})\)</p></td></tr><tr><td class="src">-&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> m</td><td class="doc"><p>New measurement \(\boldsymbol{y}_i\)</p></td></tr><tr><td class="src">-&gt; (<a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n, <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> n)</td><td class="doc"><p>New (filtered) estimate \((\hat{\boldsymbol{x}}_i, \hat{\boldsymbol{\Sigma}}_i)\)</p></td></tr></table></div></div><div class="top"><p class="src"><a id="v:runUKFPrediction" class="def">runUKFPrediction</a> <a href="src/Numeric.Kalman.html#runUKFPrediction" class="link">Source</a> <a href="#v:runUKFPrediction" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="/package/base-4.9.0.0/docs/GHC-TypeLits.html#t:KnownNat">KnownNat</a> n</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; (a -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n)</td><td class="doc"><p>System evolution function at a point
 \(\boldsymbol{a}_i(\boldsymbol{u}, \boldsymbol{x})\),
 note the order of the control and the
 input</p></td></tr><tr><td class="src">-&gt; (a -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> n)</td><td class="doc"><p>Covariance matrix encoding system evolution noise \(Q_i\)</p></td></tr><tr><td class="src">-&gt; a</td><td class="doc"><p>Dynamical input \(\boldsymbol{u}_{i-1}\)</p></td></tr><tr><td class="src">-&gt; (<a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n, <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> n)</td><td class="doc"><p>Current estimate \((\hat{\boldsymbol{x}}_{n-1}, \hat{\boldsymbol{\Sigma}}_{n-1})\)</p></td></tr><tr><td class="src">-&gt; (<a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n, <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> n)</td><td class="doc"><p>Prediction \(({\boldsymbol{x}_i^\flat}, {\boldsymbol{\Sigma}_i^\flat})\)</p></td></tr></table></div></div><div class="top"><p class="src"><a id="v:runUKFUpdate" class="def">runUKFUpdate</a> <a href="src/Numeric.Kalman.html#runUKFUpdate" class="link">Source</a> <a href="#v:runUKFUpdate" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: (<a href="/package/base-4.9.0.0/docs/GHC-TypeLits.html#t:KnownNat">KnownNat</a> n, <a href="/package/base-4.9.0.0/docs/GHC-TypeLits.html#t:KnownNat">KnownNat</a> m)</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; (a -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> m)</td><td class="doc"><p>Measurement transformation \(\boldsymbol{h}_i\)</p></td></tr><tr><td class="src">-&gt; (a -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> m)</td><td class="doc"><p>Covariance matrix encoding measurement noise \(R_i\)</p></td></tr><tr><td class="src">-&gt; a</td><td class="doc"><p>Dynamical input \(\boldsymbol{u}_{i-1}\)</p></td></tr><tr><td class="src">-&gt; (<a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n, <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> n)</td><td class="doc"><p>Current prediction \(({\boldsymbol{x}}_i^\flat, {\boldsymbol{\Sigma}}_i^\flat)\)</p></td></tr><tr><td class="src">-&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> m</td><td class="doc"><p>New measurement \(\boldsymbol{y}_i\)</p></td></tr><tr><td class="src">-&gt; (<a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n, <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> n)</td><td class="doc"><p>Updated prediction \((\hat{\boldsymbol{x}}_i, \hat{\boldsymbol{\Sigma}}_i)\)</p></td></tr></table></div></div><div class="top"><p class="src"><a id="v:runKS" class="def">runKS</a> <a href="src/Numeric.Kalman.html#runKS" class="link">Source</a> <a href="#v:runKS" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="/package/base-4.9.0.0/docs/GHC-TypeLits.html#t:KnownNat">KnownNat</a> n</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; (a -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sq">Sq</a> n)</td><td class="doc"><p>Linear system evolution at a point
 \(\boldsymbol{a}_i(\boldsymbol{u}, \boldsymbol{x})\),
 note the order of the control and the
 input</p></td></tr><tr><td class="src">-&gt; (a -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> n)</td><td class="doc"><p>Covariance matrix encoding system evolution noise \(Q_i\)</p></td></tr><tr><td class="src">-&gt; a</td><td class="doc"><p>Dynamical input \(\boldsymbol{u}_{i}\)</p></td></tr><tr><td class="src">-&gt; (<a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n, <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> n)</td><td class="doc"><p>Future smoothed estimate
 \((\bar{\boldsymbol{x}}_{i+1}, \bar{\boldsymbol{\Sigma}}_{i+1})\)</p></td></tr><tr><td class="src">-&gt; (<a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n, <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> n)</td><td class="doc"><p>Present filtered estimate
 \((\hat{\boldsymbol{x}}_{i}, \hat{\boldsymbol{\Sigma}}_{i})\)</p></td></tr><tr><td class="src">-&gt; (<a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n, <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> n)</td><td class="doc"><p>Present smoothed estimate
 \((\bar{\boldsymbol{x}}_{i}, \bar{\boldsymbol{\Sigma}}_{i})\)</p></td></tr></table></div></div><div class="top"><p class="src"><a id="v:runEKS" class="def">runEKS</a> <a href="src/Numeric.Kalman.html#runEKS" class="link">Source</a> <a href="#v:runEKS" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="/package/base-4.9.0.0/docs/GHC-TypeLits.html#t:KnownNat">KnownNat</a> n</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; (a -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n)</td><td class="doc"><p>System evolution function
 \(\boldsymbol{a}_i(\boldsymbol{u}, \boldsymbol{x})\),
 note the order of the control and the
 input</p></td></tr><tr><td class="src">-&gt; (a -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sq">Sq</a> n)</td><td class="doc"><p>Linearization of the system evolution at a point  \(\frac{\partial \boldsymbol{a}_i}{\partial \boldsymbol{x}}\big|_{{\boldsymbol{u}}, \, {\boldsymbol{x}}}\)</p></td></tr><tr><td class="src">-&gt; (a -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> n)</td><td class="doc"><p>Covariance matrix encoding system evolution noise \(Q_i\)</p></td></tr><tr><td class="src">-&gt; a</td><td class="doc"><p>Dynamical input \(\boldsymbol{u}_{i}\)</p></td></tr><tr><td class="src">-&gt; (<a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n, <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> n)</td><td class="doc"><p>Future smoothed estimate
 \((\bar{\boldsymbol{x}}_{i+1}, \bar{\boldsymbol{\Sigma}}_{i+1})\)</p></td></tr><tr><td class="src">-&gt; (<a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n, <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> n)</td><td class="doc"><p>Present filtered estimate
 \((\hat{\boldsymbol{x}}_{i}, \hat{\boldsymbol{\Sigma}}_{i})\)</p></td></tr><tr><td class="src">-&gt; (<a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n, <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> n)</td><td class="doc"><p>Present smoothed estimate
 \((\bar{\boldsymbol{x}}_{i}, \bar{\boldsymbol{\Sigma}}_{i})\)</p></td></tr></table></div><div class="doc"><p>The Kalman smoothing process (sometimes also called the
 Rauch-Tung-Striebel smoother or RTSS) is a recursive procedure for
 improving previous estimates of the system state in light of more
 recently obtained measurements.  That is, for a given state estimate
 that was produced (by a Kalman filter) using only the available
 historical data, we improve the estimate (smoothing it) using
 information that only became available later, via additional
 measurements after the estimate was originally made.  The result is an
 estimate of the state of the system at that moment in its evolution,
 taking full advantage of hindsight obtained from observations of the
 system in the future of the current step.</p><p>Consequently, the recursive smoothing procedure progresses backwards
 through the state evolution, beginning with the most recent
 observation and updating past observations given the newer
 information.  The update is made by measuring the deviation between
 what the system actually did (via observation) and what our best
 estimate of the system at that time predicted it would do, then
 adjusting the current estimate in view of this deviation.</p></div></div><div class="top"><p class="src"><a id="v:runUKS" class="def">runUKS</a> <a href="src/Numeric.Kalman.html#runUKS" class="link">Source</a> <a href="#v:runUKS" class="selflink">#</a></p><div class="subs arguments"><p class="caption">Arguments</p><table><tr><td class="src">:: <a href="/package/base-4.9.0.0/docs/GHC-TypeLits.html#t:KnownNat">KnownNat</a> n</td><td class="doc empty">&nbsp;</td></tr><tr><td class="src">=&gt; (a -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n)</td><td class="doc"><p>System evolution function
 \(\boldsymbol{a}_i(\boldsymbol{u}, \boldsymbol{x})\),</p></td></tr><tr><td class="src">-&gt; (a -&gt; <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> n)</td><td class="doc"><p>Covariance matrix encoding system evolution noise \(Q_i\)</p></td></tr><tr><td class="src">-&gt; a</td><td class="doc"><p>Dynamical input \(\boldsymbol{u}_{i}\)</p></td></tr><tr><td class="src">-&gt; (<a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n, <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> n)</td><td class="doc"><p>Future smoothed estimate
 \((\bar{\boldsymbol{x}}_{i+1}, \bar{\boldsymbol{\Sigma}}_{i+1})\)</p></td></tr><tr><td class="src">-&gt; (<a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n, <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> n)</td><td class="doc"><p>Present filtered estimate
 \((\hat{\boldsymbol{x}}_{i}, \hat{\boldsymbol{\Sigma}}_{i})\)</p></td></tr><tr><td class="src">-&gt; (<a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:R">R</a> n, <a href="/package/hmatrix-0.18.0.0/docs/Numeric-LinearAlgebra-Static.html#t:Sym">Sym</a> n)</td><td class="doc"><p>Present smoothed estimate
 \((\bar{\boldsymbol{x}}_{i}, \bar{\boldsymbol{\Sigma}}_{i})\)</p></td></tr></table></div><div class="doc"><p>Unscented Kalman smoother</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.17.2</p></div></body></html>
